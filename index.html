<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Hogrider Runner</title>
<style>
    body { margin: 0; overflow: hidden; background: #87CEEB; font-family: sans-serif; }
    canvas { display: block; margin: 0 auto; background: #87CEEB; }
    #overlay {
        position: absolute; top: 10px; left: 50%; transform: translateX(-50%);
        color: white; font-size: 24px; font-weight: bold; text-shadow: 2px 2px black;
    }
    #buttons {
        position: absolute; top: 50px; left: 50%; transform: translateX(-50%);
    }
    button {
        font-size: 16px; margin: 5px; padding: 10px;
    }
</style>
</head>
<body>
<div id="overlay">Score: 0 | High Score: 0</div>
<div id="buttons">
    <button id="startBtn">Start</button>
    <button id="pauseBtn">Pause</button>
</div>
<canvas id="gameCanvas" width="800" height="400"></canvas>

<script>
// Canvas setup
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
let score = 0;
let highScore = 0;
let gameOver = false;
let gamePaused = false;
let cinematicPlayed = false;

// Sounds
const jumpSound = new Audio("https://freesound.org/data/previews/331/331912_3248244-lq.mp3");
const hitSound = new Audio("https://freesound.org/data/previews/82/82515_1022651-lq.mp3");
const powerupSound = new Audio("https://freesound.org/data/previews/146/146725_2615117-lq.mp3");
const bgMusic = new Audio("https://freesound.org/data/previews/450/450334_5121236-lq.mp3");
bgMusic.loop = true;

// Player
class Player {
    constructor() {
        this.width = 50;
        this.height = 50;
        this.x = 50;
        this.y = canvas.height - this.height - 20;
        this.velocityY = 0;
        this.gravity = 1.2;
        this.jumpPower = -15;
        this.grounded = true;
    }
    draw() {
        ctx.fillStyle = 'brown';
        ctx.fillRect(this.x, this.y, this.width, this.height);
        ctx.fillStyle = 'black';
        ctx.fillRect(this.x+10, this.y-10, 30, 10); // head
    }
    update() {
        if (!this.grounded) {
            this.velocityY += this.gravity;
            this.y += this.velocityY;
            if (this.y + this.height >= canvas.height - 20) {
                this.y = canvas.height - this.height - 20;
                this.velocityY = 0;
                this.grounded = true;
            }
        }
        this.draw();
    }
    jump() {
        if (this.grounded) {
            this.velocityY = this.jumpPower;
            this.grounded = false;
            jumpSound.play();
        }
    }
}

// Enemy
class Enemy {
    constructor(type) {
        this.type = type;
        this.width = type === 'tall' ? 40 : 30;
        this.height = type === 'tall' ? 80 : 30;
        this.x = canvas.width + Math.random()*200;
        this.y = canvas.height - this.height - 20;
        this.speed = type === 'fast' ? 10 : 5;
    }
    draw() {
        ctx.fillStyle = this.type === 'fast' ? 'red' : (this.type === 'tall' ? 'purple' : 'green');
        ctx.fillRect(this.x, this.y, this.width, this.height);
    }
    update() {
        this.x -= this.speed;
        if (this.x + this.width < 0) {
            this.reset();
        }
        this.draw();
    }
    reset() {
        this.type = ['normal','fast','tall'][Math.floor(Math.random()*3)];
        this.width = this.type === 'tall' ? 40 : 30;
        this.height = this.type === 'tall' ? 80 : 30;
        this.speed = this.type === 'fast' ? 10 : 5;
        this.x = canvas.width + Math.random()*200;
        this.y = canvas.height - this.height - 20;
    }
}

// PowerUp
class PowerUp {
    constructor() {
        this.width = 20;
        this.height = 20;
        this.x = canvas.width + Math.random()*500;
        this.y = canvas.height - this.height - 100;
    }
    draw() {
        ctx.fillStyle = 'yellow';
        ctx.fillRect(this.x, this.y, this.width, this.height);
    }
    update() {
        this.x -= 5;
        if (this.x + this.width < 0) this.reset();
        this.draw();
    }
    reset() {
        this.x = canvas.width + Math.random()*500;
        this.y = canvas.height - this.height - 100;
    }
}

// Initialize
const player = new Player();
let enemies = [new Enemy('normal'), new Enemy('fast'), new Enemy('tall')];
let powerups = [new PowerUp()];

// Background
let bgX = 0;
function drawBackground() {
    ctx.fillStyle = '#228B22';
    ctx.fillRect(0, canvas.height-20, canvas.width, 20);
    ctx.fillStyle = '#87CEEB';
    for (let i = 0; i < canvas.width; i+=100) {
        ctx.fillRect((i+bgX)%canvas.width, 50, 50, 50); // clouds
    }
    bgX -= 2;
}

// Collision
function isColliding(a,b) {
    return a.x < b.x + b.width &&
           a.x + a.width > b.x &&
           a.y < b.y + b.height &&
           a.y + a.height > b.y;
}

// Rocket cinematic
function rocketCinematic() {
    cinematicPlayed = true;
    let rocketY = canvas.height - 100;
    const rocketInterval = setInterval(()=>{
        ctx.clearRect(0,0,canvas.width,canvas.height);
        drawBackground();
        player.update();
        ctx.fillStyle = 'orange';
        ctx.fillRect(canvas.width/2 - 25, rocketY, 50, 100); // rocket
        rocketY -= 10;
        if (rocketY + 100 < 0) {
            clearInterval(rocketInterval);
            alert("Cinematic complete! Test ending at 500 points.");
            gameOver = true;
            bgMusic.pause();
        }
    }, 30);
}

// Game loop
function update() {
    if (gameOver || gamePaused) return;
    ctx.clearRect(0,0,canvas.width,canvas.height);
    drawBackground();
    player.update();

    enemies.forEach(e=>{
        e.update();
        if (isColliding(player,e)) {
            hitSound.play();
            gameOver = true;
            bgMusic.pause();
            alert("Game Over! Score: " + score);
        }
    });

    powerups.forEach(p=>{
        p.update();
        if (isColliding(player,p)) {
            score += 50;
            powerupSound.play();
            p.reset();
        }
    });

    score += 1;
    if (score > highScore) highScore = score;

    // Boss wave
    if (score === 1200 && !enemies.some(e=>e.type==='tall')) {
        enemies.push(new Enemy('tall'));
    }

    // Cinematic rocket ending at 500 points
    if (score >= 500 && !cinematicPlayed) {
        rocketCinematic();
        return;
    }

    document.getElementById('overlay').innerText = `Score: ${score} | High Score: ${highScore}`;
    requestAnimationFrame(update);
}

// Controls
document.addEventListener('keydown', (e)=>{
    if (e.code === 'Space') player.jump();
});

document.getElementById('startBtn').addEventListener('click', ()=>{
    gameOver = false;
    gamePaused = false;
    cinematicPlayed = false;
    score = 0;
    enemies = [new Enemy('normal'), new Enemy('fast'), new Enemy('tall')];
    powerups = [new PowerUp()];
    bgMusic.play();
    update();
});

document.getElementById('pauseBtn').addEventListener('click', ()=>{
    gamePaused = !gamePaused;
    if (!gamePaused) update();
});
</script>
</body>
</html>
